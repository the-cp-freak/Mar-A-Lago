<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Minesweeper</title>
<style>
  body {
    font-family: Verdana, Tahoma, Arial, sans-serif;
    background: #7b8da6;
    background: linear-gradient(#9fb3cf, #6f8097);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    color: #000;
  }

  .game {
    background: #d4d0c8;
    padding: 8px;
    border: 2px solid #808080;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
    box-shadow: inset -1px -1px 0 #404040;
  }

  .top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #c0c0c0;
    padding: 4px;
    border: 2px solid #808080;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
    margin-bottom: 6px;
  }

  .counter {
    font-family: "Courier New", monospace;
    font-size: 20px;
    background: #000;
    color: #ff2a2a;
    padding: 2px 6px;
    border: 2px inset #333;
    min-width: 48px;
    text-align: center;
  }

  button {
    font-size: 14px;
    padding: 2px 8px;
    background: linear-gradient(#f4f4f4, #cfcfcf);
    border: 2px solid #808080;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
    cursor: pointer;
  }

  button:active {
    border-top-color: #808080;
    border-left-color: #808080;
    border-bottom-color: #ffffff;
    border-right-color: #ffffff;
  }

  select {
    width: 100%;
    margin: 6px 0;
    padding: 2px;
    font-size: 13px;
    background: #ffffff;
    border: 2px solid #808080;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
  }

  .status {
    font-size: 12px;
    text-align: center;
    margin-bottom: 4px;
    height: 16px;
  }

  .status.win { color: #006400; }
  .status.lose { color: #8b0000; }

  .board {
    display: grid;
    gap: 0;
    background: #808080;
    border: 2px solid #808080;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
  }

  .cell {
    width: 26px;
    height: 26px;
    background: linear-gradient(#e6e6e6, #bdbdbd);
    border: 1px solid #808080;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
  }

  .cell.revealed {
    background: #d4d0c8;
    border: 1px solid #a0a0a0;
  }

  .cell.flagged {
    color: #cc0000;
  }

  .cell.mine {
    background: #ff4d4d;
    border: 1px solid #800000;
    color: #000;
  }

  .n1 { color: #0000ff; }
  .n2 { color: #008000; }
  .n3 { color: #ff0000; }
  .n4 { color: #000080; }
  .n5 { color: #800000; }
</style>
</head>
<body>

<div class="game">
  <div class="top">
    <div class="counter" id="mines">000</div>
    <button onclick="restart()">ðŸ™‚</button>
    <div class="counter" id="timer">000</div>
  </div>

  <select onchange="changeDifficulty(this.value)">
    <option value="beginner">Beginner</option>
    <option value="intermediate">Intermediate</option>
    <option value="expert">Expert</option>
  </select>

  <div class="status" id="status"></div>

  <div class="board" id="board"></div>
</div>

<script>
let rows, cols, mineCount;
let board = [];
let revealed = 0;
let flags = 0;
let gameOver = false;
let timer = 0;
let timerInterval;

const difficulties = {
  beginner: [9, 9, 10],
  intermediate: [16, 16, 40],
  expert: [16, 30, 99]
};

function changeDifficulty(diff) {
  [rows, cols, mineCount] = difficulties[diff];
  restart();
}

function restart() {
  clearInterval(timerInterval);
  timer = 0;
  document.getElementById("timer").textContent = "000";
  document.getElementById("status").textContent = "";
  document.getElementById("status").className = "status";
  startTimer();
  gameOver = false;
  revealed = 0;
  flags = 0;
  createBoard();
}

function startTimer() {
  timerInterval = setInterval(() => {
    timer++;
    document.getElementById("timer").textContent =
      String(timer).padStart(3, "0");
  }, 1000);
}

function createBoard() {
  board = [];
  const boardEl = document.getElementById("board");
  boardEl.innerHTML = "";
  boardEl.style.gridTemplateColumns = `repeat(${cols}, 30px)`;

  for (let r = 0; r < rows; r++) {
    board[r] = [];
    for (let c = 0; c < cols; c++) {
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.oncontextmenu = e => flag(e, r, c);
      cell.onclick = () => reveal(r, c);
      boardEl.appendChild(cell);
      board[r][c] = {
        mine: false,
        revealed: false,
        flagged: false,
        count: 0,
        el: cell
      };
    }
  }

  placeMines();
  countMines();
  updateMineCounter();
}

function placeMines() {
  let placed = 0;
  while (placed < mineCount) {
    const r = Math.floor(Math.random() * rows);
    const c = Math.floor(Math.random() * cols);
    if (!board[r][c].mine) {
      board[r][c].mine = true;
      placed++;
    }
  }
}

function countMines() {
  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      if (board[r][c].mine) continue;
      let count = 0;
      for (let dr = -1; dr <= 1; dr++) {
        for (let dc = -1; dc <= 1; dc++) {
          if (board[r + dr]?.[c + dc]?.mine) count++;
        }
      }
      board[r][c].count = count;
    }
  }
}

function reveal(r, c) {
  const cell = board[r][c];
  if (gameOver || cell.revealed || cell.flagged) return;

  cell.revealed = true;
  cell.el.classList.add("revealed");
  revealed++;

  if (cell.mine) {
    cell.el.textContent = "ðŸ’£";
    cell.el.classList.add("mine");
    endGame(false);
    return;
  }

  if (cell.count > 0) {
    cell.el.textContent = cell.count;
    cell.el.classList.add("n" + cell.count);
  } else {
    for (let dr = -1; dr <= 1; dr++) {
      for (let dc = -1; dc <= 1; dc++) {
        if (board[r + dr]?.[c + dc]) reveal(r + dr, c + dc);
      }
    }
  }

  if (revealed === rows * cols - mineCount) endGame(true);
}

function flag(e, r, c) {
  e.preventDefault();
  const cell = board[r][c];
  if (gameOver || cell.revealed) return;

  cell.flagged = !cell.flagged;
  cell.el.textContent = cell.flagged ? "ðŸš©" : "";
  flags += cell.flagged ? 1 : -1;
  updateMineCounter();
}

function updateMineCounter() {
  document.getElementById("mines").textContent =
    String(mineCount - flags).padStart(3, "0");
}

function endGame(win) {
  gameOver = true;
  clearInterval(timerInterval);

  const status = document.getElementById("status");
  status.textContent = win ? "ðŸŽ‰ You win!" : "ðŸ’¥ Game over";
  status.classList.add(win ? "win" : "lose");

  board.flat().forEach(cell => {
    if (cell.mine && !cell.revealed) {
      cell.el.textContent = "ðŸ’£";
      cell.el.classList.add("mine");
    }
  });
}

changeDifficulty("beginner");
</script>
</body>
</html>
